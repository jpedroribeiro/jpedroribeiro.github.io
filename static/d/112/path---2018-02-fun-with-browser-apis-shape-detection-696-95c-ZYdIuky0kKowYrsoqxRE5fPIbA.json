{"data":{"site":{"siteMetadata":{"title":"J. Pedro Ribeiro","author":"J. Pedro Ribeiro"}},"markdownRemark":{"id":"d88f4ef1-e348-576a-a77b-a5c6732e5469","excerpt":"This is the second instalment of  Fun with Browser APIs , and today I’m going to talk about  Shape Detection . Spec in draft stage This is a very  experimental…","html":"<p>This is the second instalment of <a href=\"http://jpedroribeiro.com/tag/apis/\">Fun with Browser APIs</a>, and today I’m going to talk about <a href=\"https://wicg.github.io/shape-detection-api/#api\">Shape Detection</a>.</p>\n<h2>Spec in draft stage</h2>\n<p>This is a very <em>experimental</em> API, meaning, there is not a lot of documentation available. The <a href=\"https://www.w3.org/community/wicg/\">WICG</a> (<em>Web Incubator Community Group</em>) spec is very new. At the time of writing this post, the last update was January 3rd 2018. This is just a <strong>warning</strong> that it is possible that some of the methods and features described in this article might be out of date if you’re reading it later in the year.</p>\n<h2>What is it about?</h2>\n<p>The <strong>Shape Detection API</strong> does what it says on the tin: detect shapes. This is a feature that has been available on a <strong>hardware</strong> level for a while, but now it surfaced to software.</p>\n<p>This means that not only the browser you’re using has to support the API, but the device you’re using must have this capability.</p>\n<p>When we talk about shapes, we’re including:</p>\n<ul>\n<li>Faces</li>\n<li>Barcode</li>\n<li>Text</li>\n</ul>\n<h2>Face Detector</h2>\n<p>In this article I’m focusing on detecting faces. The <code class=\"language-text\">FaceDetector</code> constructor accepts an <em>options</em> param where you can set maximum number of faces to detect and whether you want it done using <em>fast mode</em> (prioritise speed over accuracy).</p>\n<h2>Using the API to detect faces in a picture</h2>\n<p>This can be achieved by doing the following:</p>\n<p>var faceDetector = new FaceDetector();\nfaceDetector\n.detect(myImageElement)\n.then(faces => {\nconsole.log(faces);\n});</p>\n<p>In this example, <code class=\"language-text\">faces</code> is a list of recognized faces. Each face comes with dimensions, coordinates and landmarks. According to the spec, landmarks can be either eyes or mouth, and each landmark object comes with its own coordinates.</p>\n<p>A working example can be found in <a href=\"https://github.com/jpedroribeiro/FunWithBrowserAPIs/tree/master/shapedetection/trek\">this GitHub repo</a>.</p>\n<h2>Using the API to detect faces on a live feed</h2>\n<p>We saw on the <a href=\"http://jpedroribeiro.com/2018/01/fun-with-browser-apis-media-stream-image-capture/\">previous article</a> that we can easily use MediaStream to capture a camera feed into a <code class=\"language-text\">video</code> element. Could we use detect shapes of this stream?</p>\n<p>Luckily for us, yes! In fact, you can use FaceDetector in any <a href=\"https://html.spec.whatwg.org/multipage/imagebitmap-and-animations.html#imagebitmapsource\">ImageBitmapSource</a>, such as:</p>\n<ul>\n<li>image</li>\n<li>video</li>\n<li>canvas</li>\n</ul>\n<p>Here is how:</p>\n<p>// #1 Start live feed\nnavigator\n.mediaDevices\n.getUserMedia({ video: true, audio: false })\n.then(mediaStream => {\nwindow.myVideoElement.srcObject = mediaStream;\n});</p>\n<p>// #2 Captures faces and display them in the browser console\nfunction faceDetectorLoop() {\nfaceDetector\n.detect(window.myVideoElement)\n.then((faces) => {\nconsole.log(faces);\nwindow.requestAnimationFrame(faceDetectorLoop); // Loops detection\n});\n}</p>\n<p>// #3 Run\nfaceDetectorLoop();</p>\n<p>We start (1) by opening up the camera feed with <code class=\"language-text\">video</code> only, then we define a function (2) that will detect faces in an infinite loop using <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame\">requestAnimationFrame</a>, and finally we start (3) the detection script.</p>\n<p>I’ve create a <strong>more complete</strong> implementation of this idea in <a href=\"https://github.com/jpedroribeiro/FunWithBrowserAPIs/tree/master/shapedetection/live\">this GitHub repo</a>, just click on the main box to start the application.</p>\n<h2>Conclusion</h2>\n<p>Shape detection is a very <strong>powerful</strong> feature that not many people is aware of. Faces, barcodes and text can be detected and used as your application needs.</p>","frontmatter":{"title":"Fun with Browser APIs: Shape Detection","date":"February 03, 2018"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2018/02/fun-with-browser-apis-shape-detection/","previous":{"fields":{"slug":"/2018/01/fun-with-browser-apis-media-stream-image-capture/"},"frontmatter":{"title":"Fun with Browser APIs: Media Stream Image Capture","tags":null}},"next":{"fields":{"slug":"/2018/03/fun-with-browser-apis-speech-recognition/"},"frontmatter":{"title":"Fun with Browser APIs: Speech Recognition","tags":null}}}}